**线性放大器失真**

放大器中的基本换能器件是晶体管，转移特性是非线性的，只有在小信号输入的约束下才能近似为线性传递。但是实际中很难始终保证输入信号幅度很小。于是放大器输出信号中便出现输入信号中没有的频率成分，即非线性失真

音频放大器失真只要有谐波失真、互调失真、瞬态失真

**谐波失真及其度量**

**总谐波失真THD（IEC,IEEE)**

**非实时等效采样**

**提高精准度**

- 等效采样——低速AD采高频信号
- 装置输入需要使用增益可控的前置放大器，设计输入信号幅度检测电路（为了适应输入信号幅度变化），给单片机提供增益控制信息，程控前端放大器增益
- MCU调用FFT算法子程序对采样信号做频谱分析。得到基波与各次谐波赋值
- 需要的精准的基频检测信息（适应输入信号频率变化），保持等效采样时钟信号与输入信号之间精准的时间同步关系。

获取基频方案

- 时域方案：过零比较器+单片机测频，得到基频估值
- 频域方案：从FFT得到的信号频谱中找基频谱，得到基频估值

**提高THD测量精度**

- 对输入信号进行带通滤波（削弱伴随输入信号的电路噪声，可在装置前端增设动态带通滤波（高通+低通），根据输入信号基频动态调整滤波器）

- 用锁相环提取输入信号的基频及其N倍频时钟信号

  - 更精准的输入信号基频提取方案——基于锁相环的硬件方案
  - 锁相环理论上可以提取出无稳态频差的基频信号，锁相倍频环能保证等效采样精度和严格的时间同步关系，为MCU的FFT提供更高质量的等效采样信号

  ![1657377214001](G:\typoraimg\img\1657377214001.png)